name: Docs Nodejs

on:
  pull_request:
    paths: [website/**]
  push:
    paths: [website/**]

permissions: # Define the permissions for the GITHUB_TOKEN
  contents: write
  actions: write
  deployments: write
  pages: write

jobs:
  node-js:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 20.x
          cache: pnpm
          cache-dependency-path: website/pnpm-lock.json

      - name: Install pnpm
        run: npm install -g pnpm

      - name: Install dependencies
        working-directory: website
        run: pnpm i

      - name: Run fmt
        working-directory: website
        run: pnpm run fmt

      - name: Check if there are any changes after formatting
        run: git diff --exit-code

      - name: Build website
        working-directory: website
        run: pnpm build
